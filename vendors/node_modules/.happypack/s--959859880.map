{"version":3,"sources":["client\\plugin.js"],"names":["hooks","pluginModule","third_login","type","mulit","listener","import_data","export_data","interface_tab","header_menu","app_route","add_reducer","sub_nav","sub_setting_nav","bindHook","name","Error","push","emitHook","args","hook","Array","isArray","promiseAll","forEach","item","resolve","call","all","pluginModuleList","require","err","plugin","module","options","exports"],"mappings":"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","file":"plugin.js","sourceRoot":"C:/Users/DUOYI/Desktop/api/test/vendors","sourcesContent":["let hooks, pluginModule;\n\n/**\n * type component  组件\n *      listener   监听函数\n * mulit 是否绑定多个监听函数\n */\n\nhooks = {\n  /**\n   * 第三方登录 //可参考 yapi-plugin-qsso 插件\n   */\n  third_login: {\n    type: 'component',\n    mulit: false,\n    listener: null\n  },\n  /**\n   * 导入数据\n   * @param Object importDataModule\n   *\n   * @info\n   * 可参考 vendors/exts/yapi-plugin-import-swagger插件\n   * importDataModule = {};\n   */\n  import_data: {\n    type: 'listener',\n    mulit: true,\n    listener: []\n  },\n  /**\n   * 导出数据\n   * @param Object exportDataModule\n   * @param projectId\n   * @info\n   * exportDataModule = {};\n   * exportDataModule.pdf = {\n   *   name: 'Pdf',\n   *   route: '/api/plugin/export/pdf',\n   *   desc: '导出项目接口文档为 pdf 文件'\n   * }\n   */\n  export_data: {\n    type: 'listener',\n    mulit: true,\n    listener: []\n  },\n  /**\n   * 接口页面 tab 钩子\n   * @param InterfaceTabs\n   *\n   * @info\n   * 可参考 vendors/exts/yapi-plugin-advanced-mock\n   * let InterfaceTabs = {\n      view: {\n        component: View,\n        name: '预览'\n      },\n      edit: {\n        component: Edit,\n        name: '编辑'\n      },\n      run: {\n        component: Run,\n        name: '运行'\n      }\n    }\n   */\n  interface_tab: {\n    type: 'listener',\n    mulit: true,\n    listener: []\n  },\n  /**\n   * header下拉菜单 menu 钩子\n   * @param HeaderMenu\n   *\n   * @info\n   * 可参考 vendors/exts/yapi-plugin-statistics\n   * let HeaderMenu = {\n  user: {\n    path: '/user/profile',\n    name: '个人中心',\n    icon: 'user',\n    adminFlag: false\n  },\n  star: {\n    path: '/follow',\n    name: '我的关注',\n    icon: 'star-o',\n    adminFlag: false\n  },\n  solution: {\n    path: '/user/list',\n    name: '用户管理',\n    icon: 'solution',\n    adminFlag: true\n\n  },\n  logout: {\n    path: '',\n    name: '退出',\n    icon: 'logout',\n    adminFlag: false\n\n  }\n};\n   */\n  header_menu: {\n    type: 'listener',\n    mulit: true,\n    listener: []\n  },\n  /**\n   * Route路由列表钩子\n   * @param AppRoute\n   *\n   * @info\n   * 可参考 vendors/exts/yapi-plugin-statistics\n   * 添加位置在Application.js 中\n   * let AppRoute = {\n  home: {\n    path: '/',\n    component: Home\n  },\n  group: {\n    path: '/group',\n    component: Group\n  },\n  project: {\n    path: '/project/:id',\n    component: Project\n  },\n  user: {\n    path: '/user',\n    component: User\n  },\n  follow: {\n    path: '/follow',\n    component: Follows\n  },\n  addProject: {\n    path: '/add-project',\n    component: AddProject\n  },\n  login: {\n    path: '/login',\n    component: Login\n  }\n};\n};\n   */\n  app_route: {\n    type: 'listener',\n    mulit: true,\n    listener: []\n  },\n  /*\n   * 添加 reducer\n   * @param Object reducerModules\n   * \n   * @info\n   * importDataModule = {}; \n   */\n\n  add_reducer: {\n    type: 'listener',\n    mulit: true,\n    listener: []\n  },\n\n  /*\n   * 添加 subnav 钩子\n   * @param Object reducerModules\n   * \n   *  let routers = {\n      interface: { name: '接口', path: \"/project/:id/interface/:action\", component:Interface },\n      activity: { name: '动态', path: \"/project/:id/activity\", component:  Activity},\n      data: { name: '数据管理', path: \"/project/:id/data\",  component: ProjectData},\n      members: { name: '成员管理', path: \"/project/:id/members\" , component: ProjectMember},\n      setting: { name: '设置', path: \"/project/:id/setting\" , component: Setting}\n    }\n   */\n  sub_nav: {\n    type: 'listener',\n    mulit: true,\n    listener: []\n  },\n  /*\n   * 添加项目设置 nav\n   * @param Object routers\n   * \n   *  let routers = {\n      interface: { name: 'xxx', component: Xxx },\n    }\n   */\n  sub_setting_nav:{\n    type: 'listener',\n    mulit: true,\n    listener: []\n  }\n};\n\nfunction bindHook(name, listener) {\n  if (!name) {\n    throw new Error('缺少hookname');\n  }\n  if (name in hooks === false) {\n    throw new Error('不存在的hookname');\n  }\n  if (hooks[name].mulit === true) {\n    hooks[name].listener.push(listener);\n  } else {\n    hooks[name].listener = listener;\n  }\n}\n\nfunction emitHook(name, ...args) {\n  if (!hooks[name]) {\n    throw new Error('不存在的hook name');\n  }\n  let hook = hooks[name];\n  if (hook.mulit === true && hook.type === 'listener') {\n    if (Array.isArray(hook.listener)) {\n      let promiseAll = [];\n      hook.listener.forEach(item => {\n        if (typeof item === 'function') {\n          promiseAll.push(Promise.resolve(item.call(pluginModule, ...args)));\n        }\n      });\n      return Promise.all(promiseAll);\n    }\n  } else if (hook.mulit === false && hook.type === 'listener') {\n    if (typeof hook.listener === 'function') {\n      return Promise.resolve(hook.listener.call(pluginModule, ...args));\n    }\n  } else if (hook.type === 'component') {\n    return hook.listener;\n  }\n}\n\npluginModule = {\n  hooks: hooks,\n  bindHook: bindHook,\n  emitHook: emitHook\n};\nlet pluginModuleList;\ntry {\n  pluginModuleList = require('./plugin-module.js');\n} catch (err) {\n  pluginModuleList = {};\n}\n\nObject.keys(pluginModuleList).forEach(plugin => {\n  if (!pluginModuleList[plugin]) return null;\n  if (pluginModuleList[plugin] && typeof pluginModuleList[plugin].module === 'function') {\n    pluginModuleList[plugin].module.call(pluginModule, pluginModuleList[plugin].options);\n  }\n});\n\nmodule.exports = pluginModule;\n"]}