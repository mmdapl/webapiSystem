{"version":3,"sources":["client\\components\\ProjectCard\\ProjectCard.js"],"names":["confirm","ProjectCard","uid","state","user","currPage","project","delFollow","addFollow","getProject","checkProjectName","copyProjectMsg","withRouter","props","copy","projectName","id","projectData","_id","data","payload","newData","draftData","preName","name","success","callbackResult","showConfirm","that","title","okText","cancelText","content","marginTop","fontSize","lineHeight","onOk","document","getElementById","value","group_id","iconType","onCancel","del","projectid","then","res","errcode","add","param","projectname","icon","constants","PROJECT_ICON","color","PROJECT_COLOR","blue","render","inFollowPage","isShow","history","push","backgroundColor","follow","Component","propTypes","PropTypes","object","number","bool","func"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;;;AAEA;;AACA;;AACA;;;;AACA;;AACA;;AACA;;;;AACA;;;;AACA;;AACA;;;;AACA,IAAMA,UAAU,gBAAMA,OAAtB;;IAkBMC,W,WAhBL,yBACC,iBAAS;AACP,SAAO;AACLC,SAAKC,MAAMC,IAAN,CAAWF,GADX;AAELG,cAAUF,MAAMG,OAAN,CAAcD;AAFnB,GAAP;AAID,CANF,EAOC;AACEE,8BADF;AAEEC,8BAFF;AAGEC,iCAHF;AAIEC,6CAJF;AAKEC;AALF,CAPD,C,oBAeAC,uB;;;AAEC,uBAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AAAA,+DACjB,sBAAMA,KAAN,CADiB;;AAAA,UAqBnBC,IArBmB;AAAA,0FAqBZ,iBAAMC,WAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AACCC,kBADD,GACM,MAAKH,KAAL,CAAWI,WAAX,CAAuBC,GAD7B;AAAA;AAAA,uBAGmB,MAAKL,KAAL,CAAWJ,UAAX,CAAsBO,EAAtB,CAHnB;;AAAA;AAGDC,2BAHC;AAIDE,oBAJC,GAIMF,YAAYG,OAAZ,CAAoBD,IAApB,CAAyBA,IAJ/B;AAKDE,uBALC,GAKS,qBAAQF,IAAR,EAAc,qBAAa;AACvCG,4BAAUC,OAAV,GAAoBD,UAAUE,IAA9B;AACAF,4BAAUE,IAAV,GAAiBT,WAAjB;AACD,iBAHa,CALT;AAAA;AAAA,uBAUC,MAAKF,KAAL,CAAWF,cAAX,CAA0BU,OAA1B,CAVD;;AAAA;AAWL,kCAAQI,OAAR,CAAgB,QAAhB;AACA,sBAAKZ,KAAL,CAAWa,cAAX;;AAZK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OArBY;;AAAA;AAAA;AAAA;AAAA;;AAAA,UAqCnBC,WArCmB,GAqCL,YAAM;AAClB,UAAMC,YAAN;;AAEA5B,cAAQ;AACN6B,eAAO,UAAUD,KAAKf,KAAL,CAAWI,WAAX,CAAuBO,IAAjC,GAAwC,OADzC;AAENM,gBAAQ,IAFF;AAGNC,oBAAY,IAHN;AAINC,iBACE;AAAA;AAAA,YAAK,OAAO,EAAEC,WAAW,MAAb,EAAqBC,UAAU,MAA/B,EAAuCC,YAAY,MAAnD,EAAZ;AACE;AACE,qEACEP,KAAKf,KAAL,CAAWI,WAAX,CAAuBO,IADzB,oIADF;AAIE,kBAAK;AAJP,YADF;AAOE;AAAA;AAAA,cAAK,OAAO,EAAES,WAAW,MAAb,EAAZ;AACE;AAAA;AAAA;AACE;AAAA;AAAA;AAAA;AAAA;AADF,aADF;AAIE,6DAAO,IAAG,cAAV,EAAyB,aAAY,0BAArC;AAJF;AAPF,SALI;AAoBAG,YApBA,kBAoBO;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACLrB,+BADK,GACS,mBAAKsB,SAASC,cAAT,CAAwB,cAAxB,EAAwCC,KAA7C,CADT;;AAGX;;AACMC,4BAJK,GAIMZ,KAAKf,KAAL,CAAWI,WAAX,CAAuBuB,QAJ7B;AAAA;AAAA,2BAKLZ,KAAKf,KAAL,CAAWH,gBAAX,CAA4BK,WAA5B,EAAyCyB,QAAzC,CALK;;AAAA;AAMXZ,yBAAKd,IAAL,CAAUC,WAAV;;AANW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOZ,SA3BK;;AA4BN0B,kBAAU,MA5BJ;AA6BNC,gBA7BM,sBA6BK,CAAE;AA7BP,OAAR;AA+BD,KAvEkB;;AAAA,UAyEnBC,GAzEmB,GAyEb,YAAM;AACV,UAAM3B,KAAK,MAAKH,KAAL,CAAWI,WAAX,CAAuB2B,SAAvB,IAAoC,MAAK/B,KAAL,CAAWI,WAAX,CAAuBC,GAAtE;AACA,YAAKL,KAAL,CAAWN,SAAX,CAAqBS,EAArB,EAAyB6B,IAAzB,CAA8B,eAAO;AACnC,YAAIC,IAAI1B,OAAJ,CAAYD,IAAZ,CAAiB4B,OAAjB,KAA6B,CAAjC,EAAoC;AAClC,gBAAKlC,KAAL,CAAWa,cAAX;AACA;AACD;AACF,OALD;AAMD,KAjFkB;;AAAA,UAmFnBsB,GAnFmB,GAmFb,YAAM;AAAA,wBACmB,MAAKnC,KADxB;AAAA,UACFX,GADE,eACFA,GADE;AAAA,UACGe,WADH,eACGA,WADH;;AAEV,UAAMgC,QAAQ;AACZ/C,gBADY;AAEZ0C,mBAAW3B,YAAYC,GAFX;AAGZgC,qBAAajC,YAAYO,IAHb;AAIZ2B,cAAMlC,YAAYkC,IAAZ,IAAoBC,mBAAUC,YAAV,CAAuB,CAAvB,CAJd;AAKZC,eAAOrC,YAAYqC,KAAZ,IAAqBF,mBAAUG,aAAV,CAAwBC;AALxC,OAAd;AAOA,YAAK3C,KAAL,CAAWL,SAAX,CAAqByC,KAArB,EAA4BJ,IAA5B,CAAiC,eAAO;AACtC,YAAIC,IAAI1B,OAAJ,CAAYD,IAAZ,CAAiB4B,OAAjB,KAA6B,CAAjC,EAAoC;AAClC,gBAAKlC,KAAL,CAAWa,cAAX;AACA;AACD;AACF,OALD;AAMD,KAlGkB;;AAEjB,UAAKsB,GAAL,GAAW,sBAAS,MAAKA,GAAd,EAAmB,GAAnB,CAAX;AACA,UAAKL,GAAL,GAAW,sBAAS,MAAKA,GAAd,EAAmB,GAAnB,CAAX;AAHiB;AAIlB;;AAgCD;;;wBAgEAc,M,qBAAS;AAAA;;AAAA,iBACuC,KAAK5C,KAD5C;AAAA,QACCI,WADD,UACCA,WADD;AAAA,QACcyC,YADd,UACcA,YADd;AAAA,QAC4BC,MAD5B,UAC4BA,MAD5B;;AAEP,WACE;AAAA;AAAA,QAAK,WAAU,gBAAf;AACE;AAAA;AAAA;AACE,oBAAU,KADZ;AAEE,qBAAU,QAFZ;AAGE,mBAAS;AAAA,mBACP,OAAK9C,KAAL,CAAW+C,OAAX,CAAmBC,IAAnB,CAAwB,eAAe5C,YAAY2B,SAAZ,IAAyB3B,YAAYC,GAApD,CAAxB,CADO;AAAA;AAHX;AAOE;AACE,gBAAMD,YAAYkC,IAAZ,IAAoB,QAD5B;AAEE,qBAAU,SAFZ;AAGE,iBAAO;AACLW,6BACEV,mBAAUG,aAAV,CAAwBtC,YAAYqC,KAApC,KAA8CF,mBAAUG,aAAV,CAAwBC;AAFnE;AAHT,UAPF;AAeE;AAAA;AAAA,YAAI,WAAU,UAAd;AAA0BvC,sBAAYO,IAAZ,IAAoBP,YAAYiC;AAA1D;AAfF,OADF;AAkBE;AAAA;AAAA;AACE,qBAAU,WADZ;AAEE,mBAASjC,YAAY8C,MAAZ,IAAsBL,YAAtB,GAAqC,KAAKf,GAA1C,GAAgD,KAAKK;AAFhE;AAIE;AAAA;AAAA;AACE,uBAAU,UADZ;AAEE,mBAAO/B,YAAY8C,MAAZ,IAAsBL,YAAtB,GAAqC,MAArC,GAA8C;AAFvD;AAIE;AACE,kBAAMzC,YAAY8C,MAAZ,IAAsBL,YAAtB,GAAqC,MAArC,GAA8C,QADtD;AAEE,uBAAW,WAAWzC,YAAY8C,MAAZ,IAAsBL,YAAtB,GAAqC,QAArC,GAAgD,EAA3D;AAFb;AAJF;AAJF,OAlBF;AAgCGC,gBACC;AAAA;AAAA,UAAK,WAAU,WAAf,EAA2B,SAAS,KAAKhC,WAAzC;AACE;AAAA;AAAA,YAAS,WAAU,UAAnB,EAA8B,OAAM,0BAApC;AACE,0DAAM,MAAK,MAAX,EAAkB,WAAU,MAA5B;AADF;AADF;AAjCJ,KADF;AA0CD,G;;;EAjJuBqC,oB,WAOjBC,S,GAAY;AACjBhD,eAAaiD,oBAAUC,MADN;AAEjBjE,OAAKgE,oBAAUE,MAFE;AAGjBV,gBAAcQ,oBAAUG,IAHP;AAIjB3C,kBAAgBwC,oBAAUI,IAJT;AAKjBV,WAASM,oBAAUC,MALF;AAMjB5D,aAAW2D,oBAAUI,IANJ;AAOjB9D,aAAW0D,oBAAUI,IAPJ;AAQjBX,UAAQO,oBAAUG,IARD;AASjB5D,cAAYyD,oBAAUI,IATL;AAUjB5D,oBAAkBwD,oBAAUI,IAVX;AAWjB3D,kBAAgBuD,oBAAUI,IAXT;AAYjBjE,YAAU6D,oBAAUE;AAZH,C;kBA6INnE,W","file":"ProjectCard.js","sourceRoot":"C:/Users/DUOYI/Desktop/api/test/vendors","sourcesContent":["import './ProjectCard.scss';\nimport React, { PureComponent as Component } from 'react';\nimport { Card, Icon, Tooltip, Modal, Alert, Input, message } from 'antd';\nimport { connect } from 'react-redux';\nimport { delFollow, addFollow } from '../../reducer/modules/follow';\nimport PropTypes from 'prop-types';\nimport { withRouter } from 'react-router';\nimport { debounce } from '../../common';\nimport constants from '../../constants/variable.js';\nimport produce from 'immer';\nimport { getProject, checkProjectName, copyProjectMsg } from '../../reducer/modules/project';\nimport { trim } from '../../common.js';\nconst confirm = Modal.confirm;\n\n@connect(\n  state => {\n    return {\n      uid: state.user.uid,\n      currPage: state.project.currPage\n    };\n  },\n  {\n    delFollow,\n    addFollow,\n    getProject,\n    checkProjectName,\n    copyProjectMsg\n  }\n)\n@withRouter\nclass ProjectCard extends Component {\n  constructor(props) {\n    super(props);\n    this.add = debounce(this.add, 400);\n    this.del = debounce(this.del, 400);\n  }\n\n  static propTypes = {\n    projectData: PropTypes.object,\n    uid: PropTypes.number,\n    inFollowPage: PropTypes.bool,\n    callbackResult: PropTypes.func,\n    history: PropTypes.object,\n    delFollow: PropTypes.func,\n    addFollow: PropTypes.func,\n    isShow: PropTypes.bool,\n    getProject: PropTypes.func,\n    checkProjectName: PropTypes.func,\n    copyProjectMsg: PropTypes.func,\n    currPage: PropTypes.number\n  };\n\n  copy = async projectName => {\n    const id = this.props.projectData._id;\n\n    let projectData = await this.props.getProject(id);\n    let data = projectData.payload.data.data;\n    let newData = produce(data, draftData => {\n      draftData.preName = draftData.name;\n      draftData.name = projectName;\n    });\n\n    await this.props.copyProjectMsg(newData);\n    message.success('项目复制成功');\n    this.props.callbackResult();\n  };\n\n  // 复制项目的二次确认\n  showConfirm = () => {\n    const that = this;\n\n    confirm({\n      title: '确认复制 ' + that.props.projectData.name + ' 项目吗？',\n      okText: '确认',\n      cancelText: '取消',\n      content: (\n        <div style={{ marginTop: '10px', fontSize: '13px', lineHeight: '25px' }}>\n          <Alert\n            message={`该操作将会复制 ${\n              that.props.projectData.name\n            } 下的所有接口集合，但不包括测试集合中的接口`}\n            type=\"info\"\n          />\n          <div style={{ marginTop: '16px' }}>\n            <p>\n              <b>项目名称:</b>\n            </p>\n            <Input id=\"project_name\" placeholder=\"项目名称\" />\n          </div>\n        </div>\n      ),\n      async onOk() {\n        const projectName = trim(document.getElementById('project_name').value);\n\n        // 查询项目名称是否重复\n        const group_id = that.props.projectData.group_id;\n        await that.props.checkProjectName(projectName, group_id);\n        that.copy(projectName);\n      },\n      iconType: 'copy',\n      onCancel() {}\n    });\n  };\n\n  del = () => {\n    const id = this.props.projectData.projectid || this.props.projectData._id;\n    this.props.delFollow(id).then(res => {\n      if (res.payload.data.errcode === 0) {\n        this.props.callbackResult();\n        // message.success('已取消关注！');  // 星号已做出反馈 无需重复提醒用户\n      }\n    });\n  };\n\n  add = () => {\n    const { uid, projectData } = this.props;\n    const param = {\n      uid,\n      projectid: projectData._id,\n      projectname: projectData.name,\n      icon: projectData.icon || constants.PROJECT_ICON[0],\n      color: projectData.color || constants.PROJECT_COLOR.blue\n    };\n    this.props.addFollow(param).then(res => {\n      if (res.payload.data.errcode === 0) {\n        this.props.callbackResult();\n        // message.success('已添加关注！');  // 星号已做出反馈 无需重复提醒用户\n      }\n    });\n  };\n\n  render() {\n    const { projectData, inFollowPage, isShow } = this.props;\n    return (\n      <div className=\"card-container\">\n        <Card\n          bordered={false}\n          className=\"m-card\"\n          onClick={() =>\n            this.props.history.push('/project/' + (projectData.projectid || projectData._id))\n          }\n        >\n          <Icon\n            type={projectData.icon || 'star-o'}\n            className=\"ui-logo\"\n            style={{\n              backgroundColor:\n                constants.PROJECT_COLOR[projectData.color] || constants.PROJECT_COLOR.blue\n            }}\n          />\n          <h4 className=\"ui-title\">{projectData.name || projectData.projectname}</h4>\n        </Card>\n        <div\n          className=\"card-btns\"\n          onClick={projectData.follow || inFollowPage ? this.del : this.add}\n        >\n          <Tooltip\n            placement=\"rightTop\"\n            title={projectData.follow || inFollowPage ? '取消关注' : '添加关注'}\n          >\n            <Icon\n              type={projectData.follow || inFollowPage ? 'star' : 'star-o'}\n              className={'icon ' + (projectData.follow || inFollowPage ? 'active' : '')}\n            />\n          </Tooltip>\n        </div>\n        {isShow && (\n          <div className=\"copy-btns\" onClick={this.showConfirm}>\n            <Tooltip placement=\"rightTop\" title=\"复制项目\">\n              <Icon type=\"copy\" className=\"icon\" />\n            </Tooltip>\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default ProjectCard;\n"]}