'use strict';

exports.__esModule = true;

var _checkbox = require('antd/lib/checkbox');

var _checkbox2 = _interopRequireDefault(_checkbox);

var _button = require('antd/lib/button');

var _button2 = _interopRequireDefault(_button);

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _inherits2 = require('babel-runtime/helpers/inherits');

var _inherits3 = _interopRequireDefault(_inherits2);

var _class, _temp;

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _propTypes = require('prop-types');

var _propTypes2 = _interopRequireDefault(_propTypes);

var _tuiEditorEditorAllMin = require('../../../common/tui-editor/dist/tui-editor-Editor-all.min.js');

var _tuiEditorEditorAllMin2 = _interopRequireDefault(_tuiEditorEditorAllMin);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

require('../../../common/tui-editor/dist/tui-editor.min.css'); // editor ui
require('../../../common/tui-editor/dist/tui-editor-contents.min.css'); // editor content
var WikiEditor = (_temp = _class = function (_Component) {
  (0, _inherits3.default)(WikiEditor, _Component);

  function WikiEditor(props) {
    (0, _classCallCheck3.default)(this, WikiEditor);

    var _this = (0, _possibleConstructorReturn3.default)(this, _Component.call(this, props));

    _this.onUpload = function () {
      var desc = _this.editor.getHtml();
      var markdown = _this.editor.getMarkdown();
      _this.props.onUpload(desc, markdown);
    };

    return _this;
  }

  WikiEditor.prototype.componentDidMount = function componentDidMount() {
    this.editor = new _tuiEditorEditorAllMin2.default({
      el: document.querySelector('#desc'),
      initialEditType: 'wysiwyg',
      height: '500px',
      initialValue: this.props.desc
    });
  };

  WikiEditor.prototype.render = function render() {
    var _props = this.props,
        isConflict = _props.isConflict,
        onCancel = _props.onCancel,
        notice = _props.notice,
        onEmailNotice = _props.onEmailNotice;

    return _react2.default.createElement(
      'div',
      null,
      _react2.default.createElement('div', {
        id: 'desc',
        className: 'wiki-editor',
        style: { display: !isConflict ? 'block' : 'none' }
      }),
      _react2.default.createElement(
        'div',
        { className: 'wiki-title wiki-up' },
        _react2.default.createElement(
          _button2.default,
          {
            icon: 'upload',
            type: 'primary',
            className: 'upload-btn',
            disabled: isConflict,
            onClick: this.onUpload
          },
          '\u66F4\u65B0'
        ),
        _react2.default.createElement(
          _button2.default,
          { onClick: onCancel, className: 'upload-btn' },
          '\u53D6\u6D88'
        ),
        _react2.default.createElement(
          _checkbox2.default,
          { checked: notice, onChange: onEmailNotice },
          '\u901A\u77E5\u76F8\u5173\u4EBA\u5458'
        )
      )
    );
  };

  return WikiEditor;
}(_react.Component), _class.propTypes = {
  isConflict: _propTypes2.default.bool,
  onUpload: _propTypes2.default.func,
  onCancel: _propTypes2.default.func,
  notice: _propTypes2.default.bool,
  onEmailNotice: _propTypes2.default.func,
  desc: _propTypes2.default.string
}, _temp);
exports.default = WikiEditor;