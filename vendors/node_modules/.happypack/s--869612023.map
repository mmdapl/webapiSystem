{"version":3,"sources":["client\\containers\\Project\\Interface\\InterfaceList\\Run\\Run.js"],"names":["Run","currInterface","state","inter","curdata","currProject","project","curUid","user","uid","withRouter","props","savePostmanRef","postman","saveCase","colId","caseName","project_id","match","params","id","interface_id","_id","case_env","req_params","req_query","req_headers","req_body_type","req_body_form","req_body_other","casename","col_id","test_res_body","axios","post","res","data","errcode","error","errmsg","success","setState","saveCaseModalVisible","componentWillMount","componentWillReceiveProps","render","env","pre_script","after_script","path","basepath","title","Component","propTypes","PropTypes","object","number"],"mappings":"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","file":"Run.js","sourceRoot":"C:/Users/DUOYI/Desktop/api/test/vendors","sourcesContent":["import React, { PureComponent as Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router';\nimport axios from 'axios';\nimport { message } from 'antd';\nimport { Postman } from '../../../../../components';\nimport AddColModal from './AddColModal';\n\n// import {\n// } from '../../../reducer/modules/group.js'\n\nimport './Run.scss';\n\n@connect(state => ({\n  currInterface: state.inter.curdata,\n  currProject: state.project.currProject,\n  curUid: state.user.uid\n}))\n@withRouter\nexport default class Run extends Component {\n  static propTypes = {\n    currProject: PropTypes.object,\n    currInterface: PropTypes.object,\n    match: PropTypes.object,\n    curUid: PropTypes.number\n  };\n\n  state = {};\n\n  constructor(props) {\n    super(props);\n  }\n\n  componentWillMount() {}\n\n  componentWillReceiveProps() {}\n\n  savePostmanRef = postman => {\n    this.postman = postman;\n  };\n\n  saveCase = async (colId, caseName) => {\n    const project_id = this.props.match.params.id;\n    const interface_id = this.props.currInterface._id;\n    const {\n      case_env,\n      req_params,\n      req_query,\n      req_headers,\n      req_body_type,\n      req_body_form,\n      req_body_other\n    } = this.postman.state;\n\n    let params = {\n      interface_id,\n      casename: caseName,\n      col_id: colId,\n      project_id,\n      case_env,\n      req_params,\n      req_query,\n      req_headers,\n      req_body_type,\n      req_body_form,\n      req_body_other\n    };\n\n    if (params.test_res_body && typeof params.test_res_body === 'object') {\n      params.test_res_body = JSON.stringify(params.test_res_body, null, '   ');\n    }\n\n    const res = await axios.post('/api/col/add_case', params);\n    if (res.data.errcode) {\n      message.error(res.data.errmsg);\n    } else {\n      message.success('添加成功');\n      this.setState({ saveCaseModalVisible: false });\n    }\n  };\n\n  render() {\n    const { currInterface, currProject } = this.props;\n    const data = Object.assign({}, currInterface, {\n      env: currProject.env,\n      pre_script: currProject.pre_script,\n      after_script: currProject.after_script\n    });\n    data.path = currProject.basepath + currInterface.path;\n    return (\n      <div>\n        <Postman\n          data={data}\n          id={currProject._id}\n          type=\"inter\"\n          saveTip=\"保存到集合\"\n          save={() => this.setState({ saveCaseModalVisible: true })}\n          ref={this.savePostmanRef}\n          interfaceId={currInterface._id}\n          projectId={currInterface.project_id}\n          curUid={this.props.curUid}\n        />\n        <AddColModal\n          visible={this.state.saveCaseModalVisible}\n          caseName={currInterface.title}\n          onCancel={() => this.setState({ saveCaseModalVisible: false })}\n          onOk={this.saveCase}\n        />\n      </div>\n    );\n  }\n}\n"]}