{"version":3,"sources":["client\\containers\\Group\\ProjectList\\ProjectList.js"],"names":["ProjectList","projectList","state","project","userInfo","tableLoading","currGroup","group","currPage","fetchProjectList","addProject","delProject","changeUpdateModal","setBreadcrumb","props","receiveRes","_id","visible","protocol","projectData","handleCancel","form","resetFields","setState","protocolChange","value","componentWillReceiveProps","nextProps","name","group_name","data","map","item","index","key","render","noFollow","followProject","i","follow","push","sort","a","b","up_time","isShow","test","role","Follow","length","NoFollow","borderBottom","marginBottom","OwnerSpace","paddingTop","textAlign","type","Component","propTypes","PropTypes","object","func","array","bool","number","studyTip","study","autobind"],"mappings":"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","file":"ProjectList.js","sourceRoot":"C:/Users/DUOYI/Desktop/api/test/vendors","sourcesContent":["import React, { PureComponent as Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { connect } from 'react-redux';\nimport { Row, Col, Button, Tooltip } from 'antd';\nimport { Link } from 'react-router-dom';\nimport {\n  addProject,\n  fetchProjectList,\n  delProject,\n  changeUpdateModal\n} from '../../../reducer/modules/project';\nimport ProjectCard from '../../../components/ProjectCard/ProjectCard.js';\nimport ErrMsg from '../../../components/ErrMsg/ErrMsg.js';\nimport { autobind } from 'core-decorators';\nimport { setBreadcrumb } from '../../../reducer/modules/user';\n\nimport './ProjectList.scss';\n\n@connect(\n  state => {\n    return {\n      projectList: state.project.projectList,\n      userInfo: state.project.userInfo,\n      tableLoading: state.project.tableLoading,\n      currGroup: state.group.currGroup,\n      currPage: state.project.currPage\n    };\n  },\n  {\n    fetchProjectList,\n    addProject,\n    delProject,\n    changeUpdateModal,\n    setBreadcrumb\n  }\n)\nclass ProjectList extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      visible: false,\n      protocol: 'http://',\n      projectData: []\n    };\n  }\n  static propTypes = {\n    form: PropTypes.object,\n    fetchProjectList: PropTypes.func,\n    addProject: PropTypes.func,\n    delProject: PropTypes.func,\n    changeUpdateModal: PropTypes.func,\n    projectList: PropTypes.array,\n    userInfo: PropTypes.object,\n    tableLoading: PropTypes.bool,\n    currGroup: PropTypes.object,\n    setBreadcrumb: PropTypes.func,\n    currPage: PropTypes.number,\n    studyTip: PropTypes.number,\n    study: PropTypes.bool\n  };\n\n  // 取消修改\n  @autobind\n  handleCancel() {\n    this.props.form.resetFields();\n    this.setState({\n      visible: false\n    });\n  }\n\n  // 修改线上域名的协议类型 (http/https)\n  @autobind\n  protocolChange(value) {\n    this.setState({\n      protocol: value\n    });\n  }\n\n  // 获取 ProjectCard 组件的关注事件回调，收到后更新数据\n\n  receiveRes = () => {\n    this.props.fetchProjectList(this.props.currGroup._id, this.props.currPage);\n  };\n\n  componentWillReceiveProps(nextProps) {\n    this.props.setBreadcrumb([{ name: '' + (nextProps.currGroup.group_name || '') }]);\n\n    // 切换分组\n    if (this.props.currGroup !== nextProps.currGroup && nextProps.currGroup._id) {\n      this.props.fetchProjectList(nextProps.currGroup._id, this.props.currPage);\n    }\n\n    // 切换项目列表\n    if (this.props.projectList !== nextProps.projectList) {\n      // console.log(nextProps.projectList);\n      const data = nextProps.projectList.map((item, index) => {\n        item.key = index;\n        return item;\n      });\n      this.setState({\n        projectData: data\n      });\n    }\n  }\n\n  render() {\n    let projectData = this.state.projectData;\n    let noFollow = [];\n    let followProject = [];\n    for (var i in projectData) {\n      if (projectData[i].follow) {\n        followProject.push(projectData[i]);\n      } else {\n        noFollow.push(projectData[i]);\n      }\n    }\n    followProject = followProject.sort((a, b) => {\n      return b.up_time - a.up_time;\n    });\n    noFollow = noFollow.sort((a, b) => {\n      return b.up_time - a.up_time;\n    });\n    projectData = [...followProject, ...noFollow];\n\n    const isShow = /(admin)|(owner)|(dev)/.test(this.props.currGroup.role);\n\n    const Follow = () => {\n      return followProject.length ? (\n        <Row>\n          <h3 className=\"owner-type\">我的关注</h3>\n          {followProject.map((item, index) => {\n            return (\n              <Col xs={8} lg={6} xxl={4} key={index}>\n                <ProjectCard projectData={item} callbackResult={this.receiveRes} />\n              </Col>\n            );\n          })}\n        </Row>\n      ) : null;\n    };\n    const NoFollow = () => {\n      return noFollow.length ? (\n        <Row style={{ borderBottom: '1px solid #eee', marginBottom: '15px' }}>\n          <h3 className=\"owner-type\">我的项目</h3>\n          {noFollow.map((item, index) => {\n            return (\n              <Col xs={8} lg={6} xxl={4} key={index}>\n                <ProjectCard projectData={item} callbackResult={this.receiveRes} isShow={isShow} />\n              </Col>\n            );\n          })}\n        </Row>\n      ) : null;\n    };\n\n    const OwnerSpace = () => {\n      return projectData.length ? (\n        <div>\n          <NoFollow />\n          <Follow />\n        </div>\n      ) : (\n        <ErrMsg type=\"noProject\" />\n      );\n    };\n\n    return (\n      <div style={{ paddingTop: '24px' }} className=\"m-panel card-panel card-panel-s project-list\">\n        <Row className=\"project-list-header\">\n          <Col span={16} style={{ textAlign: 'left' }}>\n            {this.props.currGroup.group_name} 分组共 ({projectData.length}) 个项目\n          </Col>\n          <Col span={8}>\n            {isShow ? (\n              <Link to=\"/add-project\">\n                <Button type=\"primary\">添加项目</Button>\n              </Link>\n            ) : (\n              <Tooltip title=\"您没有权限,请联系该分组组长或管理员\">\n                <Button type=\"primary\" disabled>\n                  添加项目\n                </Button>\n              </Tooltip>\n            )}\n          </Col>\n        </Row>\n        <Row>\n          {/* {projectData.length ? projectData.map((item, index) => {\n            return (\n              <Col xs={8} md={6} xl={4} key={index}>\n                <ProjectCard projectData={item} callbackResult={this.receiveRes} />\n              </Col>);\n          }) : <ErrMsg type=\"noProject\" />} */}\n          {this.props.currGroup.type === 'private' ? (\n            <OwnerSpace />\n          ) : projectData.length ? (\n            projectData.map((item, index) => {\n              return (\n                <Col xs={8} lg={6} xxl={4} key={index}>\n                  <ProjectCard\n                    projectData={item}\n                    callbackResult={this.receiveRes}\n                    isShow={isShow}\n                  />\n                </Col>\n              );\n            })\n          ) : (\n            <ErrMsg type=\"noProject\" />\n          )}\n        </Row>\n      </div>\n    );\n  }\n}\n\nexport default ProjectList;\n"]}